<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pizza_a.example.mapper.OrderMapper">
<!-- 권한 읽기 -->
	<select id="read_LastOrderItems_byusername" parameterType="String" resultType="OrderVO">
			SELECT			order_item_size			as orderItemSize,
							order_item_quantity_EA	as orderItemQuantity,
							order_item_price_won	as orderItemPrice,
							u_id					as username,
							order_address			as orderAddress,
							order_zipcode			as orderZipcode
			FROM			pizza_order ta
			LEFT JOIN		pizza_order_items tb ON ta.order_id = tb.order_id
			WHERE			ta.u_id = #{username}
			ORDER BY		order_item_id DESC
			LIMIT			0, 1
	</select>
	<insert  id="makeOrder" parameterType="String" >
			INSERT INTO		pizza_order
							(u_id,order_status,order_time)
			VALUE			(#{username},'preparing',now())			
	</insert>
	
	<select  id="StartOrder" parameterType="String" resultType="int">
			SELECT 			order_id AS orderId
			FROM 			pizza_order
			WHERE 			u_id=#{username}
			ORDER BY		order_id DESC
			LIMIT			0, 1
	</select>
	
	<insert  id="Stg2_1_setPizza_basic" parameterType="orderVO">
			INSERT INTO		pizza_order_items
							(order_id,order_item_size,order_item_quantity_EA,order_item_price_won)
			VALUE			(#{orderId},#{orderItemSize},#{orderItemQuantity},#{orderItemPrice});
	</insert>
	
	<select id="read_LastOrderInfo_byusername" parameterType="String" resultType="OrderVO">
			SELECT			u_address1 AS orderAddress,
							u_zipcode1 AS orderZipcode,
							store_id_1 AS storeId	
			FROM			pizza_user 
			WHERE			u_id =#{username}
	
	</select>
	
	
</mapper>
